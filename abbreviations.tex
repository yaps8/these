% Todo
% \newcommand{\done}[1]{}
% \newcommand{\idone}[1]{}
\newcommand{\itodo}[1]{\todo[inline]{#1}}

\newcommand{\done}[1]{\todo[color=green!80!blue!80]{D: #1}}
\newcommand{\idone}[1]{\todo[inline,color=green!80!blue!80]{Done: #1}}

\newcommand{\jym}[1]{\todo[color=red!80!blue!50]{#1}}
\newcommand{\ijym}[1]{\todo[inline,color=red!80!blue!50]{#1}}

\newcommand{\more}[1]{\todo[color=purple!60!blue!30]{M: #1}}
\newcommand{\imore}[1]{\todo[inline,color=purple!60!blue!30]{More: #1}}

\newcommand{\gdo}[1]{\todo[color=green!60!red!80]{G: #1}}
\newcommand{\igdo}[1]{\todo[inline,color=green!60!red!80]{General: #1}}

% Samples
\newcommand{\telock}{tElock}

% Color cells
\newcommand{\cnoir}{\cellcolor[gray]{0.0}}
\newcommand{\cgris}{\cellcolor[gray]{0.8}}

% Traductions
\newcommand{\Layer}{Couche}
\newcommand{\Layers}{Couches}
\newcommand{\layer}{couche}
\newcommand{\layers}{couches}
% \newcommand{\Layer}{Strate}
% \newcommand{\Layers}{Strates}
% \newcommand{\layer}{strate}
% \newcommand{\layers}{strates}

% sm
\newcommand{\sm}{auto-modifiant}
\newcommand{\sms}{auto-modifiants}
\newcommand{\nsm}{non auto-modifiant}
\newcommand{\nsms}{non auto-modifiants}

% approx
\newcommand{\sousa}{sous-approximation}
\newcommand{\sura}{sur-approximation}


% Structure
\newtheorem{pb}{Problème}[chapter]
\newtheorem{theo}{Théorème}[chapter]
\newtheorem{defi}{Définition}[chapter]
\newtheorem{prop}{Proposition}[chapter]
\newtheorem{propri}{Propriété}[chapter]
\newtheorem*{pr}{Preuve}
\newtheorem{cor}{Corollaire}[chapter]
\newtheorem{rem}{Remarque}[chapter]
% \theoremstyle{remark}\newtheorem*{preuve}{Preuve}
\AtBeginEnvironment{pb}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{theo}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{defi}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{prop}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{propri}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{pr}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{cor}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{rem}{\Needspace{5\baselineskip}}


% % Abbreviations :
\newcommand{\helloworld}{\texttt{Hello World}}
\newcommand{\nasm}{NASM}
\newcommand{\xq}{x86}
\newcommand{\xs}{x86$\_$64}
\newcommand{\pdata}{\texttt{.data}}
\newcommand{\ptext}{\texttt{.text}}

% Adresses mémoire :
\newcommand{\adr}[1]{$#1$}

% Registres
\newcommand{\eax}{\texttt{eax}}
\newcommand{\ebx}{\texttt{ebx}}
\newcommand{\ecx}{\texttt{ecx}}
\newcommand{\edx}{\texttt{edx}}
\newcommand{\edi}{\texttt{edi}}
\newcommand{\eip}{\texttt{eip}}
\newcommand{\esp}{\texttt{esp}}

% Instructions
\newcommand{\mov}{\texttt{mov}}
\newcommand{\cmp}{\texttt{cmp}}
\newcommand{\add}{\texttt{add}}
\newcommand{\jmp}{\texttt{jmp}}
\newcommand{\ret}{\texttt{ret}}
\newcommand{\call}{\texttt{call}}
\newcommand{\push}{\texttt{push}}
\newcommand{\jne}{\texttt{jne}}
\newcommand{\je}{\texttt{je}}
\newcommand{\sub}{\texttt{sub}}
\newcommand{\dec}{\texttt{dec}}
\newcommand{\nop}{\texttt{nop}}
\newcommand{\halt}{\texttt{halt}}
\newcommand{\pc}{\texttt{pc}}

% Sémantique statique
\newcommand{\BN}{\mathbb N}
\newcommand{\BE}{\mathbb E}
\newcommand{\BV}{\mathbb V}
\newcommand{\BX}{\mathbb X}
\newcommand{\BA}{\mathbb A}
\newcommand{\BP}{\mathbb P}
\newcommand{\BT}{\mathbb T}
\newcommand{\BL}{\mathbb L}
\newcommand{\BB}{\mathbb B}
\newcommand{\BNB}{\mathbb N\cup\{\bot\}}
\newcommand{\PN}{\mathcal{P}(\BN)}
\newcommand{\PMN}{\mathcal{P}_M(\BN)}
\newcommand{\Trs}{\mathbb N\cup\{\bot,\top\}}
\newcommand{\TTrs}{\mathcal P(\mathbb V\rightarrow\mathbb N\cup\{\bot,\top\})}
\newcommand{\Tr}{\PN\cup{\top,\bot}}
\newcommand{\TrM}{\PMN\cup\{\top,\bot\}}
\newcommand{\si}{\sigma_{init}}
\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}l@{}}#2\end{tabular}}
  
% Sémantique dynamique
\newcommand{\CA}{\mathcal A}
\newcommand{\CI}{\mathcal I}
\newcommand{\CC}{\mathcal C}
\newcommand{\CR}{\mathcal R}
\newcommand{\CW}{\mathcal W}
\newcommand{\da}[1]{$\CA[#1]$}
\newcommand{\di}[1]{$\CI[#1]$}
\newcommand{\dc}[1]{$\CC[#1]$}
\newcommand{\dr}[1]{$\CR[#1]$}
\newcommand{\dw}[1]{$\CW[#1]$}
\newcommand{\dww}[2]{$\CW^{#1}[#2]$}
\newcommand{\mda}[1]{\CA[#1]}
\newcommand{\mdi}[1]{\CI[#1]}
\newcommand{\mdc}[1]{\CC[#1]}
\newcommand{\mdr}[1]{\CR[#1]}
\newcommand{\mdw}[1]{\CW[#1]}
\newcommand{\mdww}[2]{\CW^{#1}[#2]}

% tikz
\tikzset{
  state/.style={
    rectangle,
    rounded corners=1pt,
    draw=black, very thick,
    minimum height=2em,
    text centered,
  },
}

%% Duqu
%  Duqu modules
\newcommand{\Crysys}{\texttt{CrySys}}
\newcommand{\duqu}{\texttt{Duqu}}
\newcommand{\stux}{\texttt{Stuxnet}}
\newcommand{\driver}{\texttt{nfrd965.sys}}
\newcommand{\netpDLL}{\texttt{NETP191.PNF}}
\newcommand{\cmiDLL}{\texttt{CMI4432.PNF}}
\newcommand{\netpCONF}{\texttt{netp192.PNF}}
\newcommand{\cmiCONF}{\texttt{CMI4464.PNF}}
\newcommand{\jminet}{\texttt{JMINET7.SYS}}
\newcommand{\cmi}{\texttt{CMI4432.SYS}}
%  Windows stuff
\newcommand{\services}{\texttt{services.exe}}
\newcommand{\PEzz}{PE$\backslash$0$\backslash$0}
\newcommand{\ZwA}{\texttt{ZwAllocateVirtualMemory}}
\newcommand{\ZwP}{\texttt{ZwProtectVirtualMemory}}
% \texttt{ZwAllocateVirtualMemory} et \texttt{ZwProtectVirtualMemory}
% itemize
% \renewcommand{\labelitemii}{$\cdot$}
% \renewcommand{\labelitemi}{$\bullet$}
% \renewcommand{\labelitemii}{$\cdot$}
% \renewcommand{\labelitemiii}{$\diamond$}
% \renewcommand{\labelitemiv}{$\ast$}