Dans ce chapitre nous présentons nos travaux sur deux programmes malveillants particuliers, Duqu et Stuxnet.
Lorsque nous avons commencé ces travaux Stuxnet était déjà documenté et détecté et Duqu venait d'être découvert.
Il a rapidement été dit qu'ils étaient semblables et nous avons donc cherché à détecter Duqu connaissant Stuxnet.
Dans un premier temps nous appliquons les travaux présentés au chapitre précédent sur ces exemples \cite{REAT12,mal12}.

Dans un second temps nous cherchons à détecter Duqu avant qu'il puisse infecter une machine cible.
Nous avons pour cela étudié un composant spécifique de Duqu, son pilote (\emph{driver}) qui permet de charger discrètement, le code malveillant en mémoire.
Notre contribution consiste en la rétroingénierie de ce composant, en la reconstitution de son code source et en une analyse de son fonctionnement.
Nous avons ensuite détourné le pilote pour en faire une version défensive capable de détecter d'éventuelles attaques similaires.
En particulier nous montrons comment le pilote de Duqu modifié aurait permis de détecter Duqu.
Ces travaux ont fait l'objet d'une publication à Malware \cite{mal13} ainsi qu'à SSTIC \cite{sstic13}.


\section{Duqu et Stuxnet}
\paragraph{Stuxnet.}
Stuxnet, découvert en juin 2010, est capable de cibler et de reprogrammer des systèmes industriels.
Sans que cela ait été prouvé, il a été avancé qu'il visait le programme nucléaire iranien. 
Symantec \cite{SymantecStux2011} indique que la plupart des systèmes infectés sont en Iran et que la cible pourrait être un système de contrôle de centrifugeuses.

\paragraph{Duqu.}
Duqu, découvert en premier par Crysys \cite{CrysysDuquStuxnet} en septembre 2011, laboratoire de sécurité et de cryptographie de l'université de Budapest, a directement été détecté comme apparenté à Stuxnet parce qu'ils utilisent des techniques d'infection et de propagation similaires.
Duqu est un outil offensif utilisé pour le vol d'informations. Symantec \cite{SymantecDuqu2011} a identifié, parmi ses fonctionnalités, des enregistreurs de frappes (\emph{keyloggers}), de l'écran, de l'activité réseau, ainsi que des outils de détection de machines sur le réseau.
Il est maintenu à jour via des serveurs de commande et de contrôle (C\&C) et dispose d'une possibilité d'auto-destruction après, typiquement, 36 jours sans nouvelles du C\&C.

Les attaques semblent réussies puisque le programme malveillant n'a pas été détecté à chaud alors que certaines opérations ont duré plusieurs mois, mais seulement post-mortem. De nombreuses souches de Duqu ont été trouvées dans la natures, chacune avec des binaire différents mais similaire. Kaspersky a publié un historique des versions \cite{KaspDuqu10}, la dernière souche détectée date de février 2012, bien après que les première attaques ne soient détectées et documentées.

\section{Analyse morphologique}

\section{Détection d'une infection}